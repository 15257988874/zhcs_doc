"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(e,t,n){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=n():"function"==typeof define&&define.amd?define(n):t.layui&&e.define?e.define(["jquery"],function(e){e("formSelects",n())}):t.formSelects=n()})("undefined"==typeof layui?null:layui,window,function(){var e="4.0.0.0713",t="xm-select",n="xm-select-parent",a="xm-select-input",i="xm-select--suffix",r="xm-select-this",o="xm-select-label",l="xm-select-search",s="xm-select-search-type",c="xm-select-show-count",d="xm-select-create",f="xm-select-create-long",u="xm-select-max",p="xm-select-skin",h="xm-select-direction",v="xm-select-height",m="xm-dis-disabled",y="xm-select-dis",g="xm-select-temp",x="xm-select-radio",k="xm-select-linkage",b="xm-select-dl",C="xm-select-hide",w="xm-hide-input",S="xm-select-sj",T="xm-select-title",j="xm-form-select",L="xm-form-selected",A="xm-select-none",H="xm-select-empty",E="xm-input",D="xm-dl-input",F="xm-select-tips",N="iconfont",O="xm-cz",I="xm-cz-group",P="请选择",V={},_={on:{},filter:{},maxTips:{}},U={type:"get",header:{},first:!0,data:{},searchUrl:"",searchName:"keyword",searchVal:null,keyName:"name",keyVal:"value",keySel:"selected",keyDis:"disabled",keyChildren:"children",dataType:"",delay:500,beforeSuccess:null,success:null,error:null,beforeSearch:null},M=[{icon:"iconfont icon-quanxuan",name:"全选",click:function(e,t){t.selectAll(e,!0,!0)}},{icon:"iconfont icon-qingkong",name:"清空",click:function(e,t){t.removeAll(e,!0,!0)}},{icon:"iconfont icon-fanxuan",name:"反选",click:function(e,t){t.reverse(e,!0,!0)}},{icon:"iconfont icon-pifu",name:"换肤",click:function(e,t){t.skin(e)}}],W=window.$||window.layui&&window.layui.jquery,B=W(window),q={},J=function(e){var n=this;this.config={name:null,max:null,maxTips:function(e,a,i){var r=W('[xid="'+n.config.name+'"]').prev().find("."+t);r.parents(".layui-form-item[pane]").length&&(r=r.parents(".layui-form-item[pane]")),r.attr("style","border-color: red !important"),setTimeout(function(){r.removeAttr("style")},300)},init:null,on:null,filter:function(e,t,n,a){return n.name.indexOf(t)==-1},clearid:-1,direction:"auto",height:null,isEmpty:!1,btns:[M[0],M[1],M[2]],searchType:0,create:function(e,t){return Date.now()},template:function(e,t,n,a){return e},showCount:0,isCreate:!1,placeholder:P,clearInput:!1},this.select=null,this.values=[],W.extend(this.config,e)},z=function(){this.appender(),this.init(),this.on(),this.initVal(),this.onreset()};z.prototype.appender=function(){Array.prototype.map||(Array.prototype.map=function(e,t){var n,a,i,r=Object(this),o=r.length>>>0;for(t&&(n=t),a=new Array(o),i=0;i<o;){var l,s;i in r&&(l=r[i],s=e.call(n,l,i,r),a[i]=s),i++}return a}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,a;if(null==this)throw new TypeError("this is null or not defined");var i=Object(this),r=i.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(n=t),a=0;a<r;){var o;a in i&&(o=i[a],e.call(n,o,a,i)),a++}})},z.prototype.init=function(e){var r=this;W(e?e:"select["+t+"]").each(function(e,f){var m=W(f),g=m.attr(t),k=m.next(".layui-form-select"),C=f.disabled,L=m.attr(u)-0,A=void 0!=m.attr(l),H=A?m.attr(l):null,F=void 0!=m.attr(d),N=void 0!=m.attr(x),O=m.attr(p),I=m.attr(h),_=f.options[0],B=m.attr(v),z=m.attr("name"),Q=m.attr("lay-verify"),X=m.attr("lay-verType"),Y="dl"==m.attr(s)?1:0,$=m.attr(c)-0||10,G=_?_.value?P:_.innerHTML||P:P,K=m.find("option[selected]").toArray().map(function(e){return{name:e.innerHTML,val:e.value}}),R=new J(N?{btns:[M[1]]}:{}),Z=V[g];V[g]=R,R.values=K,R.config.init=K.concat([]),R.config.name=g,R.config.disabled=C,R.config.max=L,R.config.isSearch=A,R.config.searchUrl=H,R.config.isCreate=F,R.config.radio=N,R.config.skin=O,R.config.direction=I,R.config.height=B,R.config.searchType=Y,R.config.formname=z,R.config.layverify=Q,R.config.layverType=X,R.config.searchType=Y,R.config.showCount=$,R.config.placeholder=G,Z&&(W.extend(!0,R.config,Z.config),C=R.config.disabled,L=R.config.max,A=R.config.isSearch,H=R.config.searchUrl,N=R.config.radio,O=R.config.skin,B=R.config.height,z=R.config.formname,Q=R.config.layverify,X=R.config.layverType,$=R.config.showCount,G=R.config.placeholder,Z.config.init&&(R.values=Z.config.init.map(function(e){return"object"==("undefined"==typeof e?"undefined":_typeof(e))?e:{name:m.find('option[value="'+e+'"]').text(),val:e}}).filter(function(e){return e.name}),R.config.init=R.values.concat([]))),(isNaN($)||$<=0)&&($=19921012),k[0]&&k.remove();var ee=r.renderSelect(g,G,f),te=B&&"auto"!=B?'xm-hg style="height: 30px;"':"",ne=['<div class="'+o+'">','<input type="text" fsw class="'+E+" "+a+'" '+(A?"":'style="display: none;"')+' autocomplete="off" debounce="0" />',"</div>"],ae=W('<div class="'+j+'" '+p+'="'+O+'">\n\t\t\t\t\t<input class="'+w+'" value="" name="'+z+'" lay-verify="'+Q+'" lay-verType="'+X+'" type="text" style="position: absolute;bottom: 0; z-index: -1;width: 100%; height: 100%; border: none; opacity: 0;"/>\n\t\t\t\t\t<div class="'+T+" "+(C?y:"")+'">\n\t\t\t\t\t\t<div class="'+E+" "+t+'" '+te+">\n\t\t\t\t\t\t\t"+ne.join("")+'\n\t\t\t\t\t\t\t<i class="'+S+'"></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="'+i+'">\n\t\t\t\t\t\t\t<input type="text" autocomplete="off" placeholder="'+G+'" readonly="readonly" unselectable="on" class="'+E+'">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<dl xid="'+g+'" class="'+b+" "+(N?x:"")+'">'+ee+"</dl>\n\t\t\t\t</div>");Z?(W('dl[xid="'+g+'"]').parents("."+n).html(ae),R.select=m):(m.wrap('<div class="'+n+'" FS_ID="'+g+'"></div>'),m.after(ae),R.select=m.remove()),A?(q[g]=W.extend(!0,{},U,{searchUrl:H}),W(document).on("input","div."+n+'[FS_ID="'+g+'"] .'+a,function(e){r.search(g,e,H)}),H&&r.triggerSearch(ae,!0)):ae.find("dl dd."+D).css("display","none")})},z.prototype.search=function(e,t,n,a){var i=this,r=void 0;if(a)r=a;else{r=t.target;var o=t.keyCode;if(9===o||13===o||37===o||38===o||39===o||40===o)return!1}var l=W.trim(r.value);this.changePlaceHolder(W(r));var s=q[e]?q[e]:U;n=s.searchUrl||n;var c=V[e],d=c.config.isCreate,f=W('dl[xid="'+e+'"]').parents("."+j);if(n){if(s.searchVal&&(l=s.searchVal,s.searchVal=""),!s.beforeSearch||s.beforeSearch&&s.beforeSearch instanceof Function&&s.beforeSearch(e,n,l)){var u=s.delay;s.first&&(s.first=!1,u=10),clearTimeout(c.clearid),c.clearid=setTimeout(function(){f.find("dl > *:not(."+F+")").remove(),f.find("dd."+A).addClass(H).text("请求中"),i.ajax(e,n,l,!1,null,!0)},u)}}else{f.find("dl ."+C).removeClass(C),f.find("dl dd:not(."+F+")").each(function(t,n){var a=W(n),i=V[e].config.filter||_.filter[e];i&&1==i(e,l,{name:a.find("span").attr("name"),val:a.attr("lay-value")},a.hasClass(m))&&a.addClass(C)}),f.find("dl dt").each(function(e,t){W(t).nextUntil("dt",":not(."+C+")").length||W(t).addClass(C)}),this.create(e,d,l);var p=f.find("dl dd:not(."+F+"):not(."+C+")");p.length?f.find("dd."+A).removeClass(H):f.find("dd."+A).addClass(H).text("无匹配项")}},z.prototype.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)},z.prototype.triggerSearch=function(e,t){var n=this;(e?[e]:W("."+j).toArray()).forEach(function(e,i){e=W(e);var r=e.find("dl").attr("xid");(r&&V[r]&&V[r].config.isEmpty||t)&&n.search(r,null,null,0==V[r].config.searchType?e.find("."+o+" ."+a):e.find("dl ."+D+" ."+a))})},z.prototype.clearInput=function(e){var t=W("."+n+'[fs_id="'+e+'"]'),i=0==V[e].config.searchType?t.find("."+o+" ."+a):t.find("dl ."+D+" ."+a);i.val("")},z.prototype.ajax=function(e,t,a,i,r,o){var l=this,s=W("."+n+' dl[xid="'+e+'"]').parents("."+j);if(s[0]&&t){var c=q[e]?q[e]:U,d=W.extend(!0,{},c.data);d[c.searchName]=a,ycya.http.ajax(t,{type:c.type||"post",headers:c.header,data:"json"==c.dataType?JSON.stringify(d):d,success:function(n){"string"==typeof n&&(n=JSON.parse(n)),c.beforeSuccess&&c.beforeSuccess instanceof Function&&(n=c.beforeSuccess(e,t,a,n)),l.isArray(n)&&(n={code:0,msg:"",data:n}),0!=n.code?s.find("dd."+A).addClass(H).text(n.msg):(s.find("dd."+A).removeClass(H),l.renderData(e,n.data,i,r,o),V[e].config.isEmpty=0==n.data.length),c.success&&c.success instanceof Function&&c.success(e,t,a,n)},error:function(n){s.find("dd[lay-value]:not(."+F+")").remove(),s.find("dd."+A).addClass(H).text("服务异常"),c.error&&c.error instanceof Function&&c.error(e,t,a,n)}})}},z.prototype.renderData=function(e,t,l,s,c){var d=this;if(l){var f=function(){var i=[],r=0,o={0:t},l=q[e]?q[e]:U,c=function(){var e=i[r++]=[],t=o;o={},W.each(t,function(t,n){W.each(n,function(n,a){var i={pid:t,name:a[l.keyName],val:a[l.keyVal]};e.push(i);var r=a[l.keyChildren];r&&r.length&&(o[i.val]=r)})})};do c();while(Object.getOwnPropertyNames(o).length);var d=W("."+n+' dl[xid="'+e+'"]').parents("."+j),f=['<div class="xm-select-linkage">'];return W.each(i,function(e,t){var n=['<div style="left: '+(s-0)*e+'px;" class="xm-select-linkage-group xm-select-linkage-group'+(e+1)+" "+(0!=e?"xm-select-linkage-hide":"")+'">'];W.each(t,function(e,t){var a='<li title="'+t.name+'" pid="'+t.pid+'" value="'+t.val+'"><span>'+t.name+"</span></li>";n.push(a)}),n.push("</div>"),f=f.concat(n)}),f.push('<div style="clear: both; height: 288px;"></div>'),f.push("</div>"),d.find("dl").html(f.join("")),d.find("."+a).css("display","none"),{v:void 0}}();if("object"===("undefined"==typeof f?"undefined":_typeof(f)))return f.v}var u=W("."+n+' dl[xid="'+e+'"]').parents("."+j),p=q[e]?q[e]:U,h=u.find("."+i+" input"),v=[];u.find("dl").html(this.renderSelect(e,h.attr("placeholder")||h.attr("back"),t.map(function(e){return e[p.keySel]&&v.push({name:e[p.keyName],val:e[p.keyVal]}),{innerHTML:e[p.keyName],value:e[p.keyVal],sel:e[p.keySel],disabled:e[p.keyDis],type:e.type,name:e.name}})));var m=u.find("."+o),y=u.find("dl[xid]");if(c){var g=V[e].values;g.forEach(function(e,t){y.find('dd[lay-value="'+e.val+'"]').addClass(r)}),v.forEach(function(t,n){d.indexOf(g,t)==-1&&(d.addLabel(e,m,t),y.find('dd[lay-value="'+t.val+'"]').addClass(r),g.push(t))})}else v.forEach(function(t,n){d.addLabel(e,m,t),y.find('dd[lay-value="'+t.val+'"]').addClass(r)}),V[e].values=v;this.commonHanler(e,m)},z.prototype.create=function(e,t,n){if(t&&n){var a=V[e],i=W('[xid="'+e+'"]'),r=i.find("dd."+F+"."+D),o=null,l=i.find("dd."+g);if(i.find("dd:not(."+F+"):not(."+g+")").each(function(e,t){n==W(t).find("span").attr("name")&&(o=t)}),!o){var s=a.config.create(e,n);l[0]?(l.attr("lay-value",s),l.find("span").text(n),l.find("span").attr("name",n),l.removeClass(C)):r.after(W(this.createDD(e,{innerHTML:n,value:s},g+" "+f)))}}else W("[xid="+e+"] dd."+g).remove()},z.prototype.createDD=function(e,t,n){var a=W.trim(t.innerHTML),i=V[e].config.template(a,t.value,t.selected,t.disabled);return'<dd lay-value="'+t.value+'" class="'+(t.disabled?m:"")+" "+(n?n:"")+'">\n\t\t\t\t\t<div class="xm-unselect xm-form-checkbox '+(t.disabled?m:"")+'">\n\t\t\t\t\t\t<i class="'+N+'"></i>\n\t\t\t\t\t\t<span name="'+a+'">'+i+"</span>\n\t\t\t\t\t</div>\n\t\t\t\t</dd>"},z.prototype.createQuickBtn=function(e,t){return'<div class="'+O+'" method="'+e.name+'" title="'+e.name+'" '+(t?'style="margin-right: '+t+'"':"")+'><i class="'+e.icon+'"></i><span>'+e.name+"</span></div>"},z.prototype.renderBtns=function(e,t,n){var a=this,i=[],r=W('dl[xid="'+e+'"]');return i.push('<div class="'+I+'" show="'+t+'" style="max-width: '+(r.prev().width()-54)+'px;">'),W.each(V[e].config.btns,function(e,t){i.push(a.createQuickBtn(t,n))}),i.push("</div>"),i.push(this.createQuickBtn({icon:"iconfont icon-caidan",name:""})),i.join("")},z.prototype.renderSelect=function(e,t,n){var i=this,r=[];return V[e].config.btns.length?(setTimeout(function(){var t=W('dl[xid="'+e+'"]');t.parents("."+j).attr(s,V[e].config.searchType),t.find("."+I).css("max-width",t.prev().width()-54+"px")},10),r.push(['<dd lay-value="" class="'+F+'" style="background-color: #FFF!important;">',this.renderBtns(e,null,"30px"),"</dd>",'<dd lay-value="" class="'+F+" "+D+'" style="background-color: #FFF!important;">','<i class="iconfont icon-sousuo"></i>','<input type="text" class="'+E+" "+a+'" placeholder="请搜索"/>',"</dd>"].join(""))):r.push('<dd lay-value="" class="'+F+'">'+t+"</dd>"),this.isArray(n)?W(n).each(function(t,n){n&&(n.type&&"optgroup"===n.type?r.push("<dt>"+n.name+"</dt>"):r.push(i.createDD(e,n)))}):W(n).find("*").each(function(t,n){("option"!=n.tagName.toLowerCase()||0!=t||n.value)&&("optgroup"===n.tagName.toLowerCase()?r.push("<dt>"+n.label+"</dt>"):r.push(i.createDD(e,n)))}),r.push('<dt style="display:none;"> </dt>'),r.push('<dd class="'+F+" "+A+" "+(2===r.length?H:"")+'">没有选项</dd>'),r.join("")},z.prototype.on=function(){var e=this;this.one(),W(document).on("click",function(t){W(t.target).parents("."+T)[0]||(W("."+n+" dl ."+C).removeClass(C),W("."+n+" dl dd."+H).removeClass(H),W("."+n+" dl dd."+g).remove(),W.each(V,function(t,n){e.clearInput(t),n.values.length||e.changePlaceHolder(W('div[FS_ID="'+t+'"] .'+o))})),W("."+n+" ."+L).removeClass(L)})},z.prototype.calcLabelLeft=function(e,t,n){var a=this.getPosition(e[0]);a.y=a.x+e[0].clientWidth;var i=e[0].offsetLeft;if(e.find("span").length)if(n){var r=e.find("span:last");r="none"==r.css("display")?r.prev()[0]:r[0];var o=this.getPosition(r);o.y=o.x+r.clientWidth,i=o.y>a.y?i-(o.y-a.y)-5:0}else if(t<0){var l=e.find(":last");l="none"==l.css("display")?l.prev()[0]:l[0];var s=this.getPosition(l);s.y=s.x+l.clientWidth,s.y>a.y&&(i-=10)}else i<0&&(i+=10),i>0&&(i=0);else i=0;e.css("left",i+"px")},z.prototype.one=function(e){var n=this;W(e?e:document).off("click","."+T).on("click","."+T,function(e){var i=W(e.target),r=i.is(T)?i:i.parents("."+T),o=r.next(),l=o.attr("xid");if(W("dl[xid]").not(o).each(function(e,t){n.clearInput(W(t).attr("xid"))}),W("dl[xid]").not(o).find("dd."+C).removeClass(C),r.hasClass(y))return!1;if(i.is("."+S)||i.is("."+a+"[readonly]"))return n.changeShow(r,!r.parents("."+j).hasClass(L)),!1;if(r.find("."+a+":not(readonly)")[0]){var s=r.find("."+a),c={x:e.pageX,y:e.pageY},d=n.getPosition(r[0]);for(r.width();c.x>d.x;){if(W(document.elementFromPoint(c.x,c.y)).is(s))return s.focus(),n.changeShow(r,!0),!1;c.x-=50}}if(i.is("."+a))return n.changeShow(r,!0),!1;if(i.is('i[fsw="'+t+'"]')){var f={name:i.prev().text(),val:i.parent().attr("value")},u=o.find("dd[lay-value='"+f.val+"']");return!u.hasClass(m)&&(n.handlerLabel(l,u,!1,f),!1)}return n.changeShow(r,!r.parents("."+j).hasClass(L)),!1}),W(e?e:document).find("dl."+b).off("click").on("click",function(e){var t=W(e.target);if(t.is("."+k)||t.parents("."+k)[0]){t=t.is("li")?t:t.parents("li");var a=t.parents(".xm-select-linkage-group"),i=t.parents("dl").attr("xid");if(!i)return!1;a.find(".xm-select-active").removeClass("xm-select-active"),t.addClass("xm-select-active"),a.nextAll(".xm-select-linkage-group").addClass("xm-select-linkage-hide");var o=a.next(".xm-select-linkage-group");if(o.find("li").addClass("xm-select-linkage-hide"),o.find('li[pid="'+t.attr("value")+'"]').removeClass("xm-select-linkage-hide"),o[0]&&0!=o.find("li:not(.xm-select-linkage-hide)").length)o.removeClass("xm-select-linkage-hide");else{var l=[],s=0,c=!t.hasClass("xm-select-this");V[i].config.radio&&t.parents(".xm-select-linkage").find(".xm-select-this").removeClass("xm-select-this");do l[s++]={name:t.find("span").text(),val:t.attr("value")},t=t.parents(".xm-select-linkage-group").prev().find('li[value="'+t.attr("pid")+'"]');while(t.length);l.reverse();var d={name:l.map(function(e){return e.name}).join("/"),val:l.map(function(e){return e.val}).join("/")};n.handlerLabel(i,null,c,d)}return!1}if(t.is("dl"))return!1;if(t.is("dt"))return t.nextUntil("dt").each(function(e,t){t=W(t),t.hasClass(m)||t.hasClass(r)||t.click()}),!1;var f=t.is("dd")?t:t.parents("dd"),u=f.parent("dl").attr("xid");if(f.hasClass(m))return!1;if(f.hasClass(F)){var p=t.is("."+O)?t:t.parents("."+O);if(!p[0])return!1;var h=p.attr("method"),v=V[u].config.btns.filter(function(e){return e.name==h})[0];return v&&v.click&&v.click instanceof Function&&v.click(u,n),!1}var y=!f.hasClass(r);return n.handlerLabel(u,f,y),!1})},z.prototype.linkageAdd=function(e,t){var n=W('dl[xid="'+e+'"]');n.find(".xm-select-active").removeClass("xm-select-active");var a=t.val.split("/"),i=void 0,r=void 0,o=0,l=[];do i=a[o],r=n.find(".xm-select-linkage-group"+(o+1)+' li[value="'+i+'"]'),r[0]&&l.push(r),o++;while(r.length&&void 0!=i);l.length==a.length&&W.each(l,function(e,t){t.addClass("xm-select-this")})},z.prototype.linkageDel=function(e,t){var n=W('dl[xid="'+e+'"]'),a=t.val.split("/"),i=void 0,r=void 0,o=a.length-1;do i=a[o],r=n.find(".xm-select-linkage-group"+(o+1)+' li[value="'+i+'"]'),r.parent().next().find("li[pid="+i+"].xm-select-this").length||r.removeClass("xm-select-this"),o--;while(r.length&&void 0!=i)},z.prototype.valToName=function(e,t){var n=W('dl[xid="'+e+'"]'),a=(t+"").split("/");if(!a.length)return null;var i=[];return W.each(a,function(e,t){var a=n.find(".xm-select-linkage-group"+(e+1)+' li[value="'+t+'"] span').text();i.push(a)}),i.length==a.length?i.join("/"):null},z.prototype.commonHanler=function(e,a){a&&a[0]&&(this.checkHideSpan(e,a),this.changePlaceHolder(a),this.retop(a.parents("."+j)),this.calcLabelLeft(a,0,!0),a.parents("."+n).find("."+w).val(V[e].values.map(function(e){return e.val}).join(",")),a.parents("."+T+" ."+t).attr("title",V[e].values.map(function(e){return e.name}).join(",")))},z.prototype.initVal=function(e){var t=this,n={};e?n[e]=V[e]:n=V,W.each(n,function(e,n){var a=n.values,i=W('dl[xid="'+e+'"]').parent(),l=i.find("."+o),s=i.find("dl");s.find("dd."+r).removeClass(r);var c=a.concat([]);c.concat([]).forEach(function(n,a){t.addLabel(e,l,n),s.find('dd[lay-value="'+n.val+'"]').addClass(r)}),n.config.radio&&c.length&&a.push(c[c.length-1]),t.commonHanler(e,l)})},z.prototype.handlerLabel=function(e,t,n,a,i){var l=W('[xid="'+e+'"]').prev().find("."+o),s=t&&{name:t.find("span").attr("name"),val:t.attr("lay-value")},c=V[e].values,d=V[e].config.on||_.on[e];a&&(s=a);var f=V[e];if(n&&f.config.max&&f.values.length>=f.config.max){var u=V[e].config.maxTips||_.maxTips[e];return void(u&&u(e,c.concat([]),s,f.max))}if(!(!i&&d&&d instanceof Function&&0==d(e,c.concat([]),s,n,t&&t.hasClass(m)))){var p=W('dl[xid="'+e+'"]');n?(t&&t[0]?(t.addClass(r),t.removeClass(g)):p.find(".xm-select-linkage")[0]&&this.linkageAdd(e,s),this.addLabel(e,l,s),c.push(s)):(t&&t[0]?t.removeClass(r):p.find(".xm-select-linkage")[0]&&this.linkageDel(e,s),this.delLabel(e,l,s),this.remove(c,s)),l[0]&&(f.config.radio&&this.changeShow(l,!1),l.parents("."+T).prev().removeClass("layui-form-danger"),f.config.clearInput&&this.clearInput(e),this.commonHanler(e,l))}},z.prototype.addLabel=function(e,n,a){if(a){var i='fsw="'+t+'"',o=[W("<span "+i+' value="'+a.val+'"><font '+i+">"+a.name+"</font></span>"),W("<i "+i+' class="iconfont icon-close"></i>')],l=o[0],s=o[1];l.append(s);var c=V[e];c.config.radio&&(c.values.length=0,W('dl[xid="'+e+'"]').find("dd."+r+':not([lay-value="'+a.val+'"])').removeClass(r),n.find("span").remove()),n.find("input").css("width","50px"),n.find("input").before(l)}},z.prototype.delLabel=function(e,t,n){n&&t.find('span[value="'+n.val+'"]:first').remove()},z.prototype.checkHideSpan=function(e,n){n.parents("."+t)[0].offsetHeight+5;n.find("span.xm-span-hide").removeClass("xm-span-hide"),n.find("span[style]").remove();var a=V[e].config.showCount;if(n.find("span").each(function(e,t){e>=a&&W(t).addClass("xm-span-hide")}),"number"==typeof a){var i=n.find("span:eq("+a+")");i[0]&&i.before(W('<span style="padding-right: 6px;" fsw="'+t+'"> + '+(n.find("span").length-a)+"</span>"))}},z.prototype.retop=function(e){var n=e.find("dl"),a=e.offset().top+e.outerHeight()+5-B.scrollTop(),i=n.outerHeight(),r=e.hasClass("layui-form-selectup")||n.css("top").indexOf("-")!=-1||a+i>B.height()&&a>=i;e=e.find("."+t);var o=V[n.attr("xid")],l=n.parents(".layui-form-pane")[0]&&n.prev()[0].clientHeight>38?14:10;if(o){if("up"==o.config.direction)return void n.css({top:"auto",bottom:"42px"});if("down"==o.config.direction)return void n.css({top:e[0].offsetTop+e.height()+l+"px",bottom:"auto"})}r?n.css({top:"auto",bottom:"42px"}):n.css({top:e[0].offsetTop+e.height()+l+"px",bottom:"auto"})},z.prototype.changeShow=function(e,t){W(".layui-form-selected").removeClass("layui-form-selected");var i=e.parents("."+j);if(W("."+n+" ."+j).not(i).removeClass(L),t)this.retop(i),i.addClass(L),i.find("."+a).focus(),i.find("dl dd[lay-value]:not(."+F+")").length||i.find("dl ."+A).addClass(H);else{var r=i.find("dl").attr("xid");i.removeClass(L),this.clearInput(r),i.find("dl ."+H).removeClass(H),i.find("dl dd."+C).removeClass(C),i.find("dl dd."+g).remove(),r&&V[r]&&V[r].config.isEmpty&&this.triggerSearch(i),this.changePlaceHolder(i.find("."+o))}},z.prototype.changePlaceHolder=function(e){var r=e.parents("."+T);if(r[0]||(r=e.parents("dl").prev()),r[0]){var o=e.parents("."+n).find("dl[xid]").attr("xid");if(V[o]&&V[o].config.height);else{var l=r.find("."+t)[0].clientHeight;r.css("height",(l>34?l+4:l)+"px");var s=r.parents("."+n).parent().prev();s.is(".layui-form-label")&&r.parents(".layui-form-pane")[0]&&(l=l>36?l+4:l,r.css("height",l+"px"),s.css({height:l+2+"px",lineHeight:l-18+"px"}))}var c=r.find("."+i+" input"),d=!e.find("span:last")[0]&&!r.find("."+a).val();if(d){var f=c.attr("back");c.removeAttr("back"),c.attr("placeholder",f)}else{var u=c.attr("placeholder");c.removeAttr("placeholder"),c.attr("back",u)}}},z.prototype.indexOf=function(e,t){for(var n=0;n<e.length;n++)if(e[n].val==t||e[n].val==(t?t.val:t)||e[n]==t||JSON.stringify(e[n])==JSON.stringify(t))return n;return-1},z.prototype.remove=function(e,t){var n=this.indexOf(e,t?t.val:t);return n>-1&&(e.splice(n,1),!0)},z.prototype.selectAll=function(e,t,n){var a=this,i=W('[xid="'+e+'"]');i[0]&&(i.find(".xm-select-linkage")[0]||i.find("dd[lay-value]:not(."+F+"):not(."+r+")"+(n?":not(."+m+")":"")).each(function(n,r){r=W(r);var o={name:r.find("span").attr("name"),val:r.attr("lay-value")};a.handlerLabel(e,i.find('dd[lay-value="'+o.val+'"]'),!0,o,!t)}))},z.prototype.removeAll=function(e,t,n){var a=this,i=W('[xid="'+e+'"]');if(i[0])return i.find(".xm-select-linkage")[0]?void V[e].values.concat([]).forEach(function(e,t){var n=e.val.split("/"),a=void 0,r=void 0,o=0;do a=n[o++],r=i.find(".xm-select-linkage-group"+o+':not(.xm-select-linkage-hide) li[value="'+a+'"]'),r.click();while(r.length&&void 0!=a)}):void V[e].values.concat([]).forEach(function(r,o){n&&i.find('dd[lay-value="'+r.val+'"]').hasClass(m)||a.handlerLabel(e,i.find('dd[lay-value="'+r.val+'"]'),!1,r,!t)})},z.prototype.reverse=function(e,t,n){var a=this,i=W('[xid="'+e+'"]');i[0]&&(i.find(".xm-select-linkage")[0]||i.find("dd[lay-value]:not(."+F+")"+(n?":not(."+m+")":"")).each(function(n,o){o=W(o);var l={name:o.find("span").attr("name"),val:o.attr("lay-value")};a.handlerLabel(e,i.find('dd[lay-value="'+l.val+'"]'),!o.hasClass(r),l,!t)}))},z.prototype.skin=function(e){var t=["default","primary","normal","warm","danger"],a=t[Math.floor(Math.random()*t.length)];W('dl[xid="'+e+'"]').parents("."+n).find("."+j).attr("xm-select-skin",a),this.check(e)&&this.commonHanler(e,W('dl[xid="'+e+'"]').parents("."+n).find("."+o))},z.prototype.getPosition=function(e){for(var t=0,n=0;null!=e;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return{x:t,y:n}},z.prototype.onreset=function(){W(document).on("click","[type=reset]",function(e){W(e.target).parents("form").find("."+n+" dl[xid]").each(function(e,t){var n=t.getAttribute("xid"),a=W(t),i=void 0,r={};X.removeAll(n),V[n].config.init.forEach(function(e,t){e&&(!r[e]||V[n].config.repeat)&&(i=a.find('dd[lay-value="'+e.val+'"]'))[0]&&(X.handlerLabel(n,i,!0),r[e]=1)})})})},z.prototype.bindEvent=function(e,t,n){t&&t instanceof Function&&(n=t,t=null),n&&n instanceof Function&&(t?V[t]?V[t].config[e]=n:_[e][t]=n:W.each(V,function(t,a){V[t]?V[t].config[e]=n:_[e][t]=n}))},z.prototype.check=function(e){return!!W('dl[xid="'+e+'"]').length||(delete V[e],!1)},z.prototype.render=function(e,t){this.check(e)&&(t=V[e].select),X.init(t),X.one(W('dl[xid="'+e+'"]').parents("."+n)),X.initVal(e)};var Q=function(){this.v=e},X=new z;return Q.prototype.value=function(e,t,n){if("string"!=typeof e)return[];var a=V[e];if(!X.check(e))return[];if("string"==typeof t||void 0==t){var i=a.values.concat([])||[];return"val"==t?i.map(function(e){return e.val}):"valStr"==t?i.map(function(e){return e.val}).join(","):"name"==t?i.map(function(e){return e.name}):"nameStr"==t?i.map(function(e){return e.name}).join(","):i}if(X.isArray(t)){var r=W('[xid="'+e+'"]'),o={},l=void 0,s=!0;0==n?s=!1:1==n?s=!0:X.removeAll(e),s&&a.values.forEach(function(e,t){o[e.val]=1}),t.forEach(function(t,n){if(t&&(!o[t]||a.config.repeat))if((l=r.find('dd[lay-value="'+t+'"]'))[0])X.handlerLabel(e,l,s,null,!0),o[t]=1;else{var i=X.valToName(e,t);i&&(X.handlerLabel(e,l,s,{name:i,val:t},!0),o[t]=1)}})}},Q.prototype.on=function(e,t){return X.bindEvent("on",e,t),this},Q.prototype.filter=function(e,t){return X.bindEvent("filter",e,t),this},Q.prototype.maxTips=function(e,t){return X.bindEvent("maxTips",e,t),this},Q.prototype.config=function(e,t,a){return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(a=1==t,t=e,e=null),t&&"object"==("undefined"==typeof t?"undefined":_typeof(t))&&(a&&(t.header||(t.header={}),t.header["Content-Type"]="application/json; charset=UTF-8",t.dataType="json"),e?(q[e]=W.extend(!0,{},q[e]||U,t),!X.check(e)&&this.render(e),V[e]&&t.direction&&(V[e].config.direction=t.direction),V[e]&&t.clearInput&&(V[e].config.clearInput=!0),t.searchUrl&&V[e]&&X.triggerSearch(W("."+n+' dl[xid="'+e+'"]').parents("."+j),!0)):(W.extend(!0,U,t),W.each(q,function(e,n){W.extend(!0,n,t)}))),this},Q.prototype.render=function(e,n){var a=this;e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(n=e,e=null);var i={};e?X.check(e)&&(i[e]=V[e]):i=V;var r=n?{init:n.init,disabled:n.disabled,max:n.max,isSearch:n.isSearch,isCreate:n.isCreate,radio:n.radio,skin:n.skin,direction:n.direction,height:n.height,formname:n.formname,layverify:n.layverify,layverType:n.layverType,searchType:"dl"==n.searchType?1:0,showCount:n.showCount,placeholder:n.placeholder,create:n.create,filter:n.filter,maxTips:n.maxTips,on:n.on,template:n.template,clearInput:n.clearInput}:{};return Object.getOwnPropertyNames(i).length&&W.each(i,function(e,t){X.check(e)&&(a.value(e,[]),W.extend(V[e].config,r),X.render(e,t.select))}),W(W("select["+t+'="'+e+'"]')[0]?"select["+t+'="'+e+'"]':"select["+t+"]").each(function(e,n){var a=n.getAttribute(t);X.render(a,n)}),this},Q.prototype.disabled=function(e){var t={};return e?X.check(e)&&(t[e]=V[e]):t={},W.each(t,function(e,t){W('dl[xid="'+e+'"]').prev().addClass(y)}),this},Q.prototype.undisabled=function(e){var t={};return e?X.check(e)&&(t[e]=V[e]):t={},W.each(t,function(e,t){W('dl[xid="'+e+'"]').prev().removeClass(y)}),this},Q.prototype.data=function(e,t,n){return e&&t&&n?(!X.check(e)&&this.render(e),this.value(e,[]),this.config(e,n),"local"==t?X.renderData(e,n.arr,1==n.linkage,n.linkageWidth?n.linkageWidth:"100"):"server"==t&&X.ajax(e,n.url,n.keyword,1==n.linkage,n.linkageWidth?n.linkageWidth:"100"),this):this},Q.prototype.btns=function(e,t,n){if(e&&X.isArray(e)&&(t=e,e=null),!t||!X.isArray(t))return this;var a={};return e?X.check(e)&&(a[e]=V[e]):a=V,t=t.map(function(e){if("string"==typeof e){if("select"==e)return M[0];if("remove"==e)return M[1];if("reverse"==e)return M[2];if("skin"==e)return M[3]}return e}),W.each(a,function(e,a){a.config.btns=t;var r=W('dl[xid="'+e+'"]').find("."+F+":first");if(t.length){var o=n&&n.show&&("name"==n.show||"icon"==n.show)?n.show:"",l=X.renderBtns(e,o,n&&n.space?n.space:"30px");r.html(l)}else{var s=r.parents("."+j).find("."+i+" input"),c=s.attr("placeholder")||s.attr("back");r.html(c),r.removeAttr("style")}}),this},Q.prototype.search=function(e,t){return e&&X.check(e)&&(q[e]=W.extend(!0,{},q[e]||U,{first:!0,searchVal:t}),X.triggerSearch(W('dl[xid="'+e+'"]').parents("."+j),!0)),this},new Q});